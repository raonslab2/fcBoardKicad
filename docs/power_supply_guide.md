# fcBoard 전원 공급 회로 가이드

## 개요

fcBoard는 DC 12V 입력을 받아 3개의 전압 레일을 생성합니다:
- **+5V** - USB, 일부 주변장치
- **+3V3** - 대부분의 디지털 IC
- **+1V8** - HDMI 칩 내부 코어

```
DC 12V Input (J16)
       │
       ▼
   +12V_IN (글로벌 네트)
       │
       ├──► U28 (LM2596S-5)    ──► +5V
       │
       ├──► U26 (LM2596S-ADJ)  ──► +3V3
       │
       └──► U27 (LM2596S-ADJ)  ──► +1V8
```

---

## 전원 입력

### DC Barrel Jack (J16)
| 항목 | 사양 |
|------|------|
| 커넥터 | 5.5mm x 2.1mm Barrel Jack |
| 입력 전압 | DC 12V |
| 권장 전류 | 5A 이상 |
| 극성 | Center Positive |

**주의사항:**
- 입력 전압 범위: 10V ~ 15V (LM2596 스펙 기준)
- 역극성 보호 없음 - 극성 확인 필수

---

## 전압 레귤레이터

### U28: LM2596S-5 (+5V 출력)

| 파라미터 | 값 |
|----------|-----|
| IC | LM2596S-5 (고정 5V 출력) |
| 입력 | +12V_IN |
| 출력 | +5V |
| 최대 전류 | 3A |
| 패키지 | TO-263-5 |

**핀 연결:**
| 핀 | 이름 | 연결 |
|----|------|------|
| 1 | VIN | +12V_IN |
| 2 | OUT | +5V (인덕터 통해) |
| 3 | GND | GND |
| 4 | FB | 내부 연결 (고정 출력) |
| 5 | ON/OFF | GND (상시 ON) |

**외부 부품:**
- L4: 33µH 인덕터 (Bourns SRN6045TA)
- D11: SS34 쇼트키 다이오드
- C20: 220µF 입력 커패시터
- C_out: 220µF 출력 커패시터

**+5V 사용처:**
- USB5744 USB Hub (VIN)
- TPS2041B USB 전원 스위치 (U7-U10)
- LED 표시등 (D12)

---

### U26: LM2596S-ADJ (+3V3 출력)

| 파라미터 | 값 |
|----------|-----|
| IC | LM2596S-ADJ (가변 출력) |
| 입력 | +12V_IN |
| 출력 | +3V3 |
| 최대 전류 | 3A |
| 패키지 | TO-263-5 |

**핀 연결:**
| 핀 | 이름 | 연결 |
|----|------|------|
| 1 | VIN | +12V_IN |
| 2 | OUT | +3V3 (인덕터 통해) |
| 3 | GND | GND |
| 4 | FB | 저항 분배기 |
| 5 | ON/OFF | GND (상시 ON) |

**출력 전압 설정:**
```
Vout = Vref × (1 + R1/R2)
Vref = 1.23V

3.3V 출력의 경우:
R1 = 1.5KΩ (R16)
R2 = 1KΩ (또는 계산값)

Vout = 1.23 × (1 + 1.5K/0.73K) ≈ 3.3V
```

**외부 부품:**
- L5: 33µH 인덕터
- D13: SS34 쇼트키 다이오드
- C21: 220µF 입력 커패시터
- C_out: 220µF 출력 커패시터
- R16, R17: FB 저항 분배기

**+3V3 사용처:**
- USB3320 ULPI PHY (U1)
- USB5744 USB Hub (VDD33)
- RTL8211F-CG Ethernet PHY (U11, U12)
- IT6801FN HDMI 수신기 (VDD33)
- IT66121FN HDMI 송신기 (VDD33)
- SN65HVD230 CAN 트랜시버 (U13, U14)
- MAX485 RS485 트랜시버 (U15, U16)
- CP2102N USB-UART (U17)
- TPD4S012 ESD 보호 (U3-U6)
- TPD12S016 HDMI ESD (U44, U45)
- LED 표시등 (D15)

---

### U27: LM2596S-ADJ (+1V8 출력)

| 파라미터 | 값 |
|----------|-----|
| IC | LM2596S-ADJ (가변 출력) |
| 입력 | +12V_IN |
| 출력 | +1V8 |
| 최대 전류 | 3A |
| 패키지 | TO-263-5 |

**핀 연결:**
| 핀 | 이름 | 연결 |
|----|------|------|
| 1 | VIN | +12V_IN |
| 2 | OUT | +1V8 (인덕터 통해) |
| 3 | GND | GND |
| 4 | FB | 저항 분배기 |
| 5 | ON/OFF | GND (상시 ON) |

**출력 전압 설정:**
```
Vout = Vref × (1 + R1/R2)
Vref = 1.23V

1.8V 출력의 경우:
R1 = 약 470Ω
R2 = 1KΩ

Vout = 1.23 × (1 + 0.47K/1K) ≈ 1.8V
```

**외부 부품:**
- L6: 33µH 인덕터
- D14: SS34 쇼트키 다이오드
- C22: 470µF 입력 커패시터
- C_out: 220µF 출력 커패시터
- R15, R20: FB 저항 분배기

**+1V8 사용처:**
- IT6801FN HDMI 수신기 (VDD18 - 내부 코어)
- IT66121FN HDMI 송신기 (VDD18 - 내부 코어)
- LED 표시등 (D16)

---

## LED 전원 표시등

각 전압 레일에 LED 표시등이 연결되어 전원 상태를 표시합니다:

| LED | 전압 | 저항 | 저항값 | LED 전류 |
|-----|------|------|--------|----------|
| D12 | +5V | R21 | 1KΩ | ~3mA |
| D15 | +3V3 | R18 | 470Ω | ~4mA |
| D16 | +1V8 | R19 | 3.3KΩ | ~0.2mA |

**회로:**
```
+5V  ──►──  D12 (LED_5V)  ──  R21 (1K)  ──  GND
+3V3 ──►──  D15 (LED_3V3) ──  R18 (470) ──  GND
+1V8 ──►──  D16 (LED_1V8) ──  R19 (3.3K) ── GND
```

**참고:** +1V8 LED는 순방향 전압(Vf ~1.6V)이 공급 전압에 가까워 밝기가 약할 수 있음

---

## 전원 네트 구조

### 파워 심볼 기반 연결

KiCad에서 파워 심볼은 **글로벌 네트**로 작동합니다. 즉, 같은 이름의 파워 심볼은 모든 시트에서 자동으로 연결됩니다.

| 파워 심볼 | 라이브러리 | 설명 |
|-----------|-----------|------|
| +12V_IN | fcBoard | DC 입력 (커스텀) |
| +5V | power | 5V 레일 |
| +3V3 | power | 3.3V 레일 |
| +1V8 | power | 1.8V 레일 |
| GND | power | 공통 접지 |

### 시트별 전원 사용

| 시트 | +12V_IN | +5V | +3V3 | +1V8 | GND |
|------|---------|-----|------|------|-----|
| Power | ✓ | ✓ | ✓ | ✓ | ✓ |
| USB | - | ✓ | ✓ | - | ✓ |
| Ethernet | - | - | ✓ | - | ✓ |
| HDMI | - | - | ✓ | ✓ | ✓ |
| Peripherals | - | - | ✓ | - | ✓ |

---

## 전류 예산

### +5V 레일 (최대 3A)
| 부하 | 예상 전류 |
|------|----------|
| USB5744 Hub | 100mA |
| USB 포트 x4 | 2A (각 500mA) |
| LED D12 | 3mA |
| **합계** | ~2.1A |

### +3V3 레일 (최대 3A)
| 부하 | 예상 전류 |
|------|----------|
| USB3320 | 50mA |
| USB5744 (3.3V) | 100mA |
| RTL8211F x2 | 200mA |
| IT6801FN (3.3V) | 100mA |
| IT66121FN (3.3V) | 100mA |
| CAN/RS485/UART | 50mA |
| ESD 보호 IC | 10mA |
| LED D15 | 4mA |
| **합계** | ~600mA |

### +1V8 레일 (최대 3A)
| 부하 | 예상 전류 |
|------|----------|
| IT6801FN (1.8V) | 150mA |
| IT66121FN (1.8V) | 150mA |
| LED D16 | 0.2mA |
| **합계** | ~300mA |

---

## 열 설계 고려사항

### LM2596 효율
- 일반적인 효율: 75-85%
- 입력-출력 전압 차이가 클수록 손실 증가

### 발열 계산 예시 (U28: 12V→5V, 2A)
```
Pin = 12V × 2A = 24W
Pout = 5V × 2A = 10W
효율 80% 가정 시:
Ploss = 24W × 0.2 = 4.8W
```

**권장사항:**
- TO-263 패키지의 탭을 PCB GND 플레인에 충분히 연결
- 고전류 사용 시 방열판 고려
- 열 비아 추가 권장

---

## PCB 레이아웃 가이드라인

### 전원 트레이스 폭
| 전류 | 권장 폭 (1oz Cu) |
|------|-----------------|
| 1A | 0.5mm |
| 2A | 1.0mm |
| 3A | 1.5mm |

### 배치 권장사항
1. 입력 커패시터를 VIN 핀 가까이 배치
2. 출력 커패시터를 OUT 핀 가까이 배치
3. FB 저항 분배기를 FB 핀 가까이 배치
4. 인덕터와 다이오드 루프 최소화
5. GND 플레인 연속성 유지

### 스위칭 노이즈 대책
- 입력/출력에 세라믹 커패시터 추가 (100nF~1µF)
- 고속 신호선과 전원 스위칭 노드 분리
- EMI 민감 회로 근처에 페라이트 비드 사용

---

## 트러블슈팅

### 출력 전압이 낮음
- 입력 전압 확인 (12V인지)
- 부하 전류 확인 (과부하?)
- FB 저항 분배기 값 확인

### 출력 전압이 높음
- FB 핀 연결 확인
- FB 저항 분배기 값 확인
- 부하 연결 확인 (무부하 시 약간 높을 수 있음)

### 과열
- 입력 전압 확인
- 부하 전류 측정
- 열 방출 경로 확인
- 효율 개선 고려 (더 낮은 입력 전압 또는 2단계 변환)

### LED가 안 켜짐
- 해당 전압 레일 출력 확인
- LED 극성 확인
- 저항값 확인

---

## 부품 리스트 (전원부)

| Reference | Part | Value | Footprint |
|-----------|------|-------|-----------|
| J16 | DC Barrel Jack | 5.5x2.1mm | BarrelJack_Horizontal |
| U28 | LM2596S-5 | 5V/3A | TO-263-5 |
| U26 | LM2596S-ADJ | 3.3V/3A | TO-263-5 |
| U27 | LM2596S-ADJ | 1.8V/3A | TO-263-5 |
| L4, L5, L6 | Inductor | 33µH | Bourns SRN6045TA |
| D11, D13, D14 | Schottky | SS34 | SMA |
| D12 | LED | Green | 0603 |
| D15 | LED | Green | 0603 |
| D16 | LED | Green | 0603 |
| C20, C21, C23 | Capacitor | 220µF | SMD |
| C22 | Capacitor | 470µF | SMD |
| R21 | Resistor | 1KΩ | 0402 |
| R18 | Resistor | 470Ω | 0402 |
| R19 | Resistor | 3.3KΩ | 0402 |
| R15 | Resistor | 470Ω (FB, +1V8 상단) | 0402 |
| R20 | Resistor | 1KΩ (FB, +1V8 하단) | 0402 |
| R16 | Resistor | 1.5KΩ (FB, +3V3 하단) | 0402 |
| R17 | Resistor | 1KΩ (FB, +3V3 상단) | 0402 |

---

## 참고 자료

- [LM2596 데이터시트](https://www.ti.com/lit/ds/symlink/lm2596.pdf)
- [Switching Regulator Design Guide](https://www.ti.com/lit/an/slva477b/slva477b.pdf)
- KiCad 프로젝트: `fcBoard_Power.kicad_sch`
